{"filter":false,"title":"_form.html","tooltip":"/app/views/reservations/_form.html","undoManager":{"mark":1,"position":1,"stack":[[{"start":{"row":6,"column":6},"end":{"row":6,"column":7},"action":"remove","lines":["="],"id":337}],[{"start":{"row":6,"column":6},"end":{"row":6,"column":7},"action":"insert","lines":["="],"id":338}],[{"start":{"row":45,"column":13},"end":{"row":46,"column":0},"action":"remove","lines":["",""],"id":344}],[{"start":{"row":46,"column":0},"end":{"row":46,"column":8},"action":"remove","lines":["  </div>"],"id":343}],[{"start":{"row":47,"column":6},"end":{"row":48,"column":0},"action":"remove","lines":["",""],"id":342}],[{"start":{"row":48,"column":0},"end":{"row":49,"column":0},"action":"remove","lines":["",""],"id":341}],[{"start":{"row":48,"column":0},"end":{"row":164,"column":9},"action":"remove","lines":["","","<script>","","  function checkDate(date) {","    dmy = date.getDate() + \"-\" + (date.getMonth() + 1) + \"-\" + date.getFullYear();","    return [$.inArray(dmy, unavailableDates) == -1];","  }","","  $(function() {","","    unavailableDates = [];","","    $.ajax({","      url: '<%= preload_stylist_path(@stylist) %>',","      dateTyp: 'json',","      success: function(data) {","","        $.each(data, function(arrID, arrValue) {","            for(var d = new Date(arrValue.start_date); d <= new Date(arrValue.end_date); d.setDate(d.getDate() + 1)) {","              unavailableDates.push($.datepicker.formatDate('d-m-yy', d));","            }","        });","        ","        $('.timepicker').timepicker()","          .on('changeTime', function(ev) {","          alert('time has changed');","        });","        ","        $('#reservation_start_date').datepicker({","          dateFormat: 'dd-mm-yy',","          minDate: 0,","          maxDate: '3m',","          beforeShowDay: checkDate,","          onSelect: function(selected) {","            $('#reservation_end_date').datepicker(\"option\", \"minDate\", selected);","            $('#reservation_end_date').attr(\"disabled\", false);","","            var start_date = $('#reservation_start_date').datepicker('getDate');","            var end_date = $('#reservation_end_date').datepicker('getDate');","            var nights = (end_date - start_date)/1000/60/60/24 + 1;","","            var input = {","              'start_date': start_date,","              'end_date': end_date","            }","","            $.ajax({","              url: '<%= preview_room_path(@stylist) %>',","              data: input,","              success: function(data) {","","                if(data.conflict) {","                  $('#message').text(\"These dates are not available.\");","                  $('#preview').hide();","                  $('#btn_book').attr('disabled', true);","                } else {","                  $('#message').text(\"\");","                  $('#preview').show();","                  $('#btn_book').attr('disabled', false);","","                  var total = nights * <%= @stylist.price %>","                  $('#reservation_nights').text(nights);","                  $('#reservation_total').text(total);","                }","              }","            });","","          }","        });","","        $('#reservation_end_date').datepicker({","          dateFormat: 'dd-mm-yy',","          minDate: 0,","          maxDate: '3m',","          beforeShowDay: checkDate,","          onSelect: function(selected) {","            $('#reservation_start_date').datepicker(\"option\", \"maxDate\", selected);","","            var start_date = $('#reservation_start_date').datepicker('getDate');","            var end_date = $('#reservation_end_date').datepicker('getDate');","            var nights = (end_date - start_date)/1000/60/60/24 + 1;","","            var input = {","              'start_date': start_date,","              'end_date': end_date","            }","","            $.ajax({","              url: '<%= preview_room_path(@stylist) %>',","              data: input,","              success: function(data) {","","                if(data.conflict) {","                  $('#message').text(\"These dates are not available.\");","                  $('#preview').hide();","                  $('#btn_book').attr('disabled', true);","                } else {","                  $('#message').text(\"\");","                  $('#preview').show();","                  $('#btn_book').attr('disabled', false);","","                  var total = nights * <%= @stylist.price %>","                  $('#reservation_nights').text(nights);","                  $('#reservation_total').text(total);","                }","              }","            });","          }","        });","      }","    });","","","","  });","</script>"],"id":340}],[{"start":{"row":6,"column":0},"end":{"row":6,"column":65},"action":"remove","lines":["    <%= form_for([@stylist, @stylist.reservations.new]) do |f| %>"],"id":339}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":6,"column":0},"end":{"row":6,"column":65},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1503932653972,"hash":"d0fac4cf36c847f0fd85df91a16f56942bdc912f"}