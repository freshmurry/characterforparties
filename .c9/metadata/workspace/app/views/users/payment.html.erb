{"changed":true,"filter":false,"title":"payment.html.erb","tooltip":"/app/views/users/payment.html.erb","value":"<div class=\"row\">\n  <div class=\"col-md-3\">\n    <ul class=\"sidebar-list\">\n      <li class=\"sidebar-item\"><%= link_to \"Payment Method\", payment_method_path, class: \"sidebar-link active\" %></li>\n      <li class=\"sidebar-item\"><%= link_to \"Payout Method\", payout_method_path, class: \"sidebar-link\" %></li>\n      <li class=\"sidebar-item\"><%= link_to \"Notification Settings\", notification_settings_path, class: \"sidebar-link\" %></li>\n    </ul>\n  </div>\n\n  <div class=\"col-md-9\">\n    <div class=\"panel panel-default\">\n      <div class=\"panel-heading\">Payment Method</div>\n      <div class=\"panel-body\">\n        <div class=\"container\">\n            <%= form_tag(\"/add_card\", method: \"post\", id: \"add-card\") do %>\n\n                <label>\n                  <span>Name</span>\n                  <input name=\"cardholder-name\" class=\"field\" placeholder=\"Billy Jean\" />\n                </label>\n\n                <label>\n                  <span>Card</span>\n                  <div id=\"card-element\" class=\"field\"></div>\n                </label>\n\n                <div class=\"outcome\">\n                  <div class=\"error\" role=\"alert\"></div>\n                </div>\n\n                <% if current_user.stripe_id %>\n                  <button type=\"submit\" class=\"btn btn-normal btn-block\">Update Card</button>\n                <% else %>\n                  <button type=\"submit\" class=\"btn btn-normal btn-block\">Add Card</button>\n                  <p>*Card info is never saved, super secure, and fully protected up to 256-bit SSL encryption</p>\n                <% end %>\n\n            <% end %>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<script src=\"https://js.stripe.com/v3/\"></script>\n<script>\n  $(function() {\n    \n    // ----- TEST -----\n    // var stripe = Stripe('pk_test_WYMTzyGZ9KXIM7ckP4mIDQEa');\n    // ----- LIVE -----\n    var stripe = Stripe('pk_live_tPxK7gw5a2XVBKxCgAdATbwf');\n    var elements = stripe.elements();\n\n    var card = elements.create('card', {\n      hidePostalCode: true,\n      style: {\n        base: {\n          iconColor: '#F99A52',\n          color: '#32315E',\n          lineHeight: '48px',\n          fontWeight: 400,\n          fontFamily: '\"Helvetica Neue\", \"Helvetica\", sans-serif',\n          fontSize: '15px',\n\n          '::placeholder': {\n            color: '#CFD7DF',\n          }\n        },\n      }\n    });\n\n    card.mount('#card-element');\n\n    function setOutcome(result) {\n\n      var errorElement = document.querySelector('.error');\n      errorElement.classList.remove('visible');\n\n      if (result.token) {\n        var form = $('#add-card');\n        form.append($('<input type=\"hidden\" name=\"stripeToken\">').val(result.token.id));\n        form.get(0).submit();\n      } else if (result.error) {\n        errorElement.textContent = result.error.message;\n        errorElement.classList.add('visible');\n      }\n    }\n\n    card.on('change', function(event) {\n      setOutcome(event);\n    });\n\n    $('#add-card').on('submit', function(e) {\n      e.preventDefault();\n      var extraDetails = {\n        name: $('input[name=cardholder-name]').value\n      };\n      stripe.createToken(card, extraDetails).then(setOutcome);\n    });\n\n  });\n</script>","undoManager":{"mark":1,"position":-1,"stack":[[{"start":{"row":49,"column":4},"end":{"row":49,"column":7},"action":"remove","lines":["// "],"id":14}],[{"start":{"row":51,"column":4},"end":{"row":51,"column":7},"action":"insert","lines":["// "],"id":14}]]},"ace":{"folds":[],"scrolltop":761.5,"scrollleft":0,"selection":{"start":{"row":51,"column":60},"end":{"row":51,"column":60},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1521875501201}